# Урок 5. Условное форматирование, фильтры и сортировки

## 1. Назначение

Инструменты **условного форматирования**, **фильтров** и **сортировок** — это базовые средства анализа данных в Excel.  
Они позволяют быстро находить нужную информацию, визуально выделять закономерности и подготавливать данные для отчётов без сложных формул.

Использование этих инструментов помогает:
- упорядочивать большие массивы данных по нужным признакам;
- выделять отклонения и тенденции цветом или значками;
- отбирать только нужные строки для анализа;
- считать итоги только по видимым данным.

## 2. Условное форматирование

### 2.1. Базовые правила

**Условное форматирование** автоматически изменяет внешний вид ячеек в зависимости от их содержимого.  
Настройки выполняются на вкладке **Главная → Условное форматирование**.

| Тип правила | Назначение | Пример |
|--------------|-------------|---------|
| **Больше / Меньше / Между** | Выделяет значения, выходящие за заданные пределы | `>100000` |
| **Текст содержит** | Подсветка по ключевому слову | «менеджер» |
| **Дата** | Выделяет даты «вчера», «сегодня», «этот месяц» | `Сегодня()` |
| **Дубликаты** | Подсветка повторяющихся или уникальных значений | — |
| **Топ/Боттом 10** | Показывает наилучшие или худшие показатели | Топ-10 продаж |
| **Выше/Ниже среднего** | Сравнение с общим уровнем | Среднее значение по отделу |

### 2.2. Визуальные стили

Excel предлагает готовые способы визуализации данных:

| Тип оформления | Описание | Пример применения |
|----------------|-----------|-------------------|
| **Гистограммы** | Полоски внутри ячеек, показывающие величину значения | Уровень выполнения плана |
| **Цветовые шкалы** | Градиент от минимального к максимальному значению | Распределение продаж |
| **Наборы значков** | Символы (стрелки, кружки, флажки) по диапазонам значений | KPI, статусы, риски |

### 2.3. Правила по формулам

Базовые правила ограничены встроенными параметрами.  
Если нужно задать сложное условие — используйте **«Формулу для определения форматируемых ячеек»**.

Формула должна возвращать **ИСТИНА (TRUE)**, если форматирование нужно применить.

| Задача | Формула | Примечание |
|--------|----------|------------|
| Подсветить строки с просроченным сроком | `=$E2<СЕГОДНЯ()` | Проверка по дате |
| Выделить всю строку, если статус = "Критично" | `=$F2="Критично"` | Фиксируем столбец `$F` |
| Подсветить строки, где выполнение <80% | `=$G2<0,8` | Проверка числового условия |
| Подсветить чётные строки («зебра») | `=ОСТАТ(СТРОКА();2)=0` | Для читаемости таблиц |

## 3. Фильтры

### 3.1. Автофильтр

Автофильтр позволяет временно скрыть ненужные строки и отобразить только те, что соответствуют заданным условиям.

**Как включить:**
- Сочетание клавиш **Ctrl + Shift + L**;
- Или вкладка **Данные → Фильтр**.

| Тип фильтра | Назначение | Пример |
|--------------|-------------|---------|
| **Числовой** | Отбор по диапазону значений | «Больше чем 100000» |
| **Текстовый** | Отбор по словам или частям слов | «Содержит менеджер» |
| **Дата и время** | Отбор по дням, месяцам, годам | «Этот месяц» |
| **По цвету** | Фильтрация по цвету ячейки или шрифта | Красным выделены ошибки |
| **Топ-10** | Показывает первые или последние значения | 10 крупнейших клиентов |

### 3.2. Расширенный фильтр

**Расширенный фильтр** используется, когда стандартных условий недостаточно.

1. Задайте область критериев на листе (названия столбцов должны совпадать).  
2. Перейдите на вкладку **Данные → Дополнительно (Advanced)**.  
3. Укажите диапазон данных и диапазон критериев.  
4. При необходимости отметьте «Только уникальные записи» или «Копировать результат в другое место».

**Пример области критериев:**  

| Отдел | Оклад |
| ----- | ----- |
| Продажи | >100000 |

Такой фильтр покажет всех сотрудников отдела Продаж с окладом выше 100 000 ₽.  
Для логики **«ИЛИ»** добавляют вторую строку критериев:

| Отдел | Оклад |
| ----- | ----- |
| Продажи |  |
|  | >100000 |

## 4. Сортировки

### 4.1. Базовая сортировка
- Числа: от меньшего к большему / от большего к меньшему.  
- Текст: от А до Я / от Я до А.  
- Даты: от старых к новым / от новых к старым.

### 4.2. Многоуровневая сортировка

Когда нужно упорядочить данные по нескольким критериям:
1. Вкладка **Данные → Сортировка**.  
2. Добавьте уровни (например: Отдел → Должность → Оклад).  
3. Укажите порядок для каждого уровня.

| Уровень | Поле | Порядок |
|----------|------|---------|
| 1 | Отдел | А–Я |
| 2 | Должность | А–Я |
| 3 | Оклад | По убыванию |

### 4.3. Сортировка по цвету и значкам

Если таблица отформатирована условным форматированием, можно сортировать по:
- цвету заливки ячейки,
- цвету шрифта,
- иконкам набора значков.

### 4.4. Пользовательские списки

Иногда алфавитная сортировка не подходит (например, «Пн, Вт, Ср...» или «Критично, Высокий, Средний, Низкий»).  
В этом случае можно задать **пользовательский порядок**:
1. В диалоге «Сортировка» выберите поле «Порядок → Список пользовательский».  
2. Введите нужную последовательность.

## 5. Рекомендации

- Перед анализом данных **включать фильтр** (`Ctrl + Shift + L`).  
- **Не сортировать один столбец отдельно**, чтобы не нарушить соответствие данных.  
- При создании правил условного форматирования **фиксировать столбцы** с помощью `$`, если нужно применить правило ко всей строке.  
- Для визуализации применять **цветовые шкалы и значки**, но избегать чрезмерного количества правил.  
- Проверять, не остались ли активные фильтры перед итоговыми расчётами. 
