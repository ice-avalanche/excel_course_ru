# Урок 7. Сводные таблицы и диаграммы в Excel

## 1. Назначение

**Сводные таблицы** – это мощный инструмент анализа данных, который позволяет быстро обобщать большие объемы информации без формул.

**Сводные диаграммы** строятся на основе сводных таблиц и позволяют визуально представить результаты анализа.

Преимущества:

* мгновенный пересчет при изменении данных;
* гибкая настройка группировок и фильтров;
* поддержка автоматического обновления при изменении источника;
* возможность создавать интерактивные дашборды.

## 2. Создание сводной таблицы

### 2.1. Из диапазона

1. Выделить диапазон с данными (включая заголовки).
2. Перейти на вкладку **Вставка → Сводная таблица**.
3. В окне **Создание сводной таблицы** выбрать:

   * диапазон или имя таблицы (`Таблица1`);
   * место размещения – **на новом** или **существующем листе**.
4. Нажать **ОК** – откроется пустая структура сводной таблицы.

### 2.2. Из умной таблицы

Если исходные данные оформлены как **умная таблица (Ctrl+T)** – Excel сам будет обновлять диапазон при добавлении строк.

## 3. Структура и элементы сводной таблицы

| Элемент              | Назначение                                                                    |
| -------------------- | ----------------------------------------------------------------------------- |
| **Область строк**    | Категории, по которым выполняется группировка (например, регионы, сотрудники) |
| **Область столбцов** | Показатели, отображаемые горизонтально (например, месяцы, годы)               |
| **Область значений** | Числовые данные (сумма, среднее, количество и т. д.)                          |
| **Фильтры отчета**   | Отбор данных перед построением (например, только «2025 год»)                  |

## 4. Основные операции

### 4.1. Изменение функции расчета

1. Щелкнуть по ячейке с числом → **Значения поля → Настройки поля значений**.
2. Выбрать функцию:

   * **Сумма**
   * **Количество**
   * **Среднее**
   * **Максимум / Минимум**
   * **Процент от итога / от строки / от столбца**

### 4.2. Форматирование чисел

ПКМ → **Числовой формат** → выбрать нужный стиль (валюта, процент, разделители).

### 4.3. Изменение макета

**Конструктор → Макет отчета**:

* «Компактная форма» (по умолчанию),
* «В виде структуры»,
* «В виде таблицы».

## 5. Группировка данных

### 5.1. По числовым полям

Выделить число → **Группировать**.
Можно задать шаг (например, по 100 000 ₽).

### 5.2. По датам

Выделить дату → **Группировать** → выбрать период:
**Дни, Месяцы, Кварталы, Годы** (можно выбрать несколько одновременно).

### 5.3. По тексту

Для логических объединений использовать **Создать группу** – например, объединить несколько категорий в «Север» и «Юг».

## 6. Фильтры, срезы и временные шкалы

### 6.1. Фильтры отчета

Размещаются над таблицей и позволяют отбирать данные по выбранному значению (например, «Отдел продаж»).

### 6.2. Срезы

**Анализ сводной таблицы → Вставить срез** → выбрать поле (например, «Регион»).
Появится интерактивное меню для фильтрации по кнопкам.

### 6.3. Временная шкала

**Анализ сводной таблицы → Вставить временную шкалу** → выбрать поле с датами.
Можно фильтровать по месяцам, кварталам, годам, неделям.

## 7. Вычисляемые поля и элементы

### 7.1. Вычисляемое поле

Добавляет собственные формулы в сводную таблицу.
**Анализ сводной таблицы → Поля, элементы и наборы → Вычисляемое поле**.

**Пример:**
`=Выручка - Себестоимость` → новое поле «Прибыль».

### 7.2. Вычисляемый элемент

Позволяет создавать новые категории внутри поля.
Например, объединить несколько регионов в «Центральный округ».

## 8. Сводные диаграммы

1. Выделить сводную таблицу → **Анализ → Сводная диаграмма**.
2. Выбрать тип диаграммы (гистограмма, график, круговая и т. д.).
3. При изменении фильтров или срезов диаграмма обновляется автоматически.

## 9. Обновление и связь с источником данных

* **ПКМ → Обновить** – пересчитать значения по обновленным данным.
* **Анализ сводной таблицы → Параметры → Данные → Обновлять при открытии файла**.
* Для внешних источников (Power Query, база данных, CSV) используется **Обновить все**.

## 10. Расширенные возможности

| Возможность                                 | Описание                                                          |
| ------------------------------------------- | ----------------------------------------------------------------- |
| **Показать детали**                         | Двойной щелчок по числу открывает строки-источники                |
| **Сводные отчеты по нескольким диапазонам** | Объединение таблиц через Power Query или «Объединенные диапазоны» |
| **Сводные таблицы из модели данных**        | Использование нескольких связанных таблиц                         |
| **Меры DAX (в Excel 365/Power Pivot)**      | Расчеты на уровне модели, например `SUMX`, `CALCULATE`, `FILTER`  |
| **Поля и элементы набора**                  | Расширенные вычисления и сценарии «что-если»                      |

## 11. Рекомендации

* Начинать с чистых и структурированных данных.
* Для обновляемых источников использовать **умные таблицы** или **Power Query**.
* Не объединять ячейки, т.к. это мешает построению.
* Настраивать поля в логическом порядке.
* Добавлять срезы и диаграммы (они делают отчет интерактивным).
* Сохранять готовые шаблоны отчетов с примерами фильтров и форматирования.
