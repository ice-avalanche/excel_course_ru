# Урок 14. Дашборды

## 1. Назначение

Дашборд – это интерактивная панель мониторинга, которая объединяет ключевые показатели (KPI), графики и фильтры на одном экране.

Цель дашборда:
- быстро показать текущее состояние бизнеса;
- выявить отклонения;
- поддержать управленческие решения;
- сократить время анализа.

## 2. Принципы построения дашборда

Хороший дашборд:

- отвечает на конкретный управленческий вопрос;
- содержит только ключевые метрики;
- понятен без дополнительных пояснений;
- обновляется автоматически.

### Основные принципы

| Принцип | Суть |
|----------|------|
| Фокус | Только важные показатели |
| Иерархия | Главное – крупнее, второстепенное – компактнее |
| Единый стиль | Одинаковые цвета и форматирование |
| Минимализм | Без лишнего декора |
| Интерактивность | Фильтры, срезы, переключатели |

## 3. Архитектура дашборда

Рекомендуемая структура файла:

| Лист | Назначение |
|------|------------|
| `Data` | Исходные данные |
| `Model` | Расчёты, агрегирование |
| `Dashboard` | Визуальная панель |

Важно:
- пользователь работает только с листом `Dashboard`;
- расчёты скрыты;
- данные обновляются автоматически.

## 4. KPI-блок

KPI – это числовые показатели, отображаемые в виде карточек.

### Примеры KPI:

- Общая выручка
- Маржинальность
- Количество клиентов
- Средний чек
- Выполнение плана (%)

### Пример формул:

```excel
=СУММ(Data[Выручка])
=СРЗНАЧ(Data[Маржа])
=Факт/План
````

### Условное форматирование:

* зелёный – выполнение ≥ 100%
* жёлтый – 90-100%
* красный – < 90%

## 5. Основные элементы дашборда

| Элемент                 | Назначение             |
| ----------------------- | ---------------------- |
| Сводные таблицы         | Агрегация данных       |
| Сводные диаграммы       | Динамические графики   |
| Срезы                   | Фильтрация             |
| Временная шкала         | Фильтр по датам        |
| Комбинированные графики | ₽ и % на одном графике |
| Спарклайны              | Мини-графики в ячейках |

## 6. Интерактивность

### Срезы

1. Выделить сводную таблицу.
2. Анализ → Вставить срез.
3. Выбрать поле (Регион, Продукт и т.д.).

Можно подключать один срез к нескольким сводным таблицам.

### Временная шкала

Используется для фильтрации по датам:

* месяц;
* квартал;
* год.

### Связь нескольких таблиц

Если используется Модель данных:

* одна таблица фактов;
* несколько измерений;
* единый набор срезов.

## 7. Визуальные блоки

### Динамика

Тип графика: линейный.

### Структура

Тип графика: столбчатая с накоплением / кольцевая.

### Сравнение план–факт

Тип графика: комбинированный.

Пример:

* столбцы – факт;
* линия – план.

## 8. Продвинутые элементы

### Каскадная диаграмма

Анализ прибыли:
Выручка → Себестоимость → Операционные расходы → Чистая прибыль.

### Воронка

Анализ продаж:
Лиды → Контакты → КП → Сделки.

### Спарклайны

Мини-графики внутри таблицы:
Вставка → Спарклайны.

## 9. Автоматизация обновления

### Обновление данных

```vba
Sub RefreshDashboard()
    ThisWorkbook.RefreshAll
End Sub
```

Можно назначить макрос на кнопку «Обновить».

## 10. Дизайн дашборда

### Цветовая схема

* 2-3 основных цвета;
* зелёный – рост;
* красный – снижение;
* серый – второстепенное.

### Рекомендации

* Фон – светлый.
* Без 3D-эффектов.
* Без лишних подписей.
* Выравнивание по сетке.
* Одинаковая высота KPI-карточек.

## 11. Типовые управленческие дашборды

| Тип              | Показатели                          |
| ---------------- | ----------------------------------- |
| Финансовый       | Выручка, прибыль, маржа, отклонения |
| Продажи          | План–факт, конверсия, средний чек   |
| HR               | Текучесть, фонд оплаты труда        |
| Производственный | Выпуск, брак, эффективность         |
