# Урок 4. Умные таблицы

## 1. Назначение

**Умные таблицы** — это особый тип диапазона данных в Excel, который автоматически расширяется, форматируется и поддерживает структурированные ссылки.  
Такой формат позволяет удобно анализировать данные, применять формулы, фильтры и создавать динамические отчёты.

Использование умных таблиц обеспечивает:
- автоматическое распространение формул и форматирования;
- удобное обращение к данным по именам столбцов;
- интеграцию с другими инструментами Excel (сводные таблицы, Power Query, диаграммы);
- снижение количества ошибок при расчётах и обновлениях.

## 2. Создание и преобразование диапазона в таблицу

Создать умную таблицу можно **тремя способами**.

### 1. С помощью сочетания клавиш
1. Выделите диапазон данных, включая заголовки.  
2. Нажмите **Ctrl + T**.  
3. Убедитесь, что установлена галочка **«Таблица с заголовками»**.  
4. Нажмите **ОК** — таблица создана.

### 2. Через ленту меню
1. Выделите диапазон.  
2. Перейдите на вкладку **Главная → Форматировать как таблицу**.  
3. Выберите подходящий стиль оформления.  
4. Подтвердите диапазон и наличие заголовков.

### 3. Через вкладку «Вставка»
1. Выберите диапазон.  
2. Откройте вкладку **Вставка → Таблица**.  
3. Убедитесь, что диапазон выбран верно, и отметьте «Таблица с заголовками».  

После создания таблицы Excel автоматически применяет стиль, включает автофильтры и добавляет контекстную вкладку **Конструктор таблиц** (или **Работа с таблицами**).

## 3. Основные возможности

| Возможность                     | Описание                                                                                   |
|---------------------------------|---------------------------------------------------------------------------------------------|
| **Автоматическое расширение**   | При добавлении новых строк или столбцов таблица увеличивается автоматически.               |
| **Автоматическое копирование формул** | Формула, введённая в одной строке, распространяется на весь столбец.                     |
| **Автофильтры и сортировка**    | В заголовках появляются стрелки для быстрого анализа данных.                              |
| **Единые стили оформления**     | Применяются готовые цветовые схемы и чередование строк.                                   |
| **Строка итогов**               | Включается через **Конструктор → Строка итогов**, функции выбираются из выпадающих списков.|
| **Интеграция с другими инструментами** | Таблица обновляется во всех связанных диаграммах, сводных таблицах и запросах Power Query.|

## 4. Конструктор таблиц

После преобразования диапазона в умную таблицу в Excel появляется контекстная вкладка **«Конструктор таблиц»**.  
Эта вкладка содержит все основные инструменты для настройки и управления таблицей.

### Основные элементы вкладки:

| Группа инструментов | Назначение |
|----------------------|------------|
| **Свойства** | Изменение имени таблицы и диапазона данных. Рекомендуется задавать осмысленные имена — например, `Продажи2025` или `Сотрудники`. |
| **Инструменты** | Создание сводной таблицы, удаление дубликатов, преобразование таблицы обратно в диапазон, создание среза. |
| **Данные из внешней таблицы** | Экспорт данных, обновление связей с внешними источниками. |
| **Параметры стилей таблиц** | Настройка визуальных элементов: включение/отключение строки заголовков, строки итогов, полос строк и столбцов, выделения первой и последней строк. |
| **Стили таблиц** | Выбор оформления (цветовая схема, границы, заливка), а также возможность сохранить собственный стиль. |

## 5. Структурированные ссылки

Структурированные ссылки заменяют обычные диапазоны (`B2:B10`) на осмысленные обращения к элементам таблицы.

### Синтаксис:
```

=ФУНКЦИЯ(ИмяТаблицы[ИмяСтолбца])

```

### Примеры:

| Задача | Формула |
|--------|----------|
| Сумма всех продаж | `=СУММ(Продажи[Выручка])` |
| Средний оклад | `=СРЗНАЧ(Сотрудники[Оклад])` |
| Расчёт внутри строки | `=[@Количество]*[@Цена]` |
| Ссылка на диапазон столбцов | `=СРЗНАЧ(Продажи[[Количество]:[Цена]])` |

### Специальные элементы:
| Обозначение | Значение |
|--------------|-----------|
| `[#Все]` | Вся таблица (включая заголовки и итоги) |
| `[#Данные]` | Только строки с данными |
| `[#Заголовки]` | Строка заголовков |
| `[#Итоги]` | Строка итогов |

## 6. Работа с формулами и функциями

Умные таблицы поддерживают все функции Excel, обеспечивая удобочитаемость и динамичное обновление формул.

| Цель | Формула | Описание |
|------|----------|-----------|
| Сумма выручки | `=СУММ(Продажи[Выручка])` | Автоматически учитывает новые строки |
| Среднее выполнение плана | `=СРЗНАЧ(Сотрудники[Факт]/Сотрудники[План])` | Не требует ручного расширения диапазона |
| Проверка условия | `=ЕСЛИ([@Факт]>=100%;"Выполнил";"Нет")` | Логическое сравнение внутри строки |
| Доля сотрудника в общем плане | `=[@Факт]/СУММ(Сотрудники[Факт])` | Рассчитывает вклад в общий результат |

**Преимущества:**
- формулы автоматически обновляются при добавлении строк;
- диапазоны защищены от ошибок при переименовании столбцов;
- таблицы легко использовать как источники для сводных и визуализаций.

## 7. Интеграция с другими инструментами Excel

| Инструмент | Как работает с умными таблицами | Преимущества |
|-------------|---------------------------------|--------------|
| **Сводные таблицы** | Используют таблицу как динамический источник данных | Автоматическое обновление диапазона |
| **Диаграммы** | Основаны на именованном диапазоне таблицы | Графики обновляются при добавлении строк |
| **Power Query** | Загружает таблицу по имени | Удобно для обработки и объединения данных |
| **Динамические функции (365/2021)** | `ФИЛЬТР`, `УНИК`, `СОРТИРОВАТЬ` работают с таблицами напрямую | Гибкие отчёты без ручных диапазонов |

## 8. Рекомендации

- Начинать анализ данных с **преобразования диапазона в умную таблицу**.  
- Присваивать **понятные имена** таблицам и столбцам.  
- Использовать вкладку **Конструктор таблиц** для настройки структуры и оформления.  
- Проверять автоматическое расширение при добавлении строк.  
- Комбинировать умные таблицы с фильтрами, сводными таблицами и Power Query.  
- Избегать объединения ячеек — они мешают корректной работе таблиц.  
